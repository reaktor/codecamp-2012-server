<html>
<head>
  <link rel="stylesheet" href="css/mannapuuro.css"/>
  <script src="/socket.io/socket.io.js"></script>
  <script src="js/jquery-1.4.4.js"></script>
  <script src="js/template.js"></script>
  <script>
    console.log("Hello Nasty")
    var socket = new io.Socket();
    console.log("Hello Nasty again")
    socket.on('connect', function() {console.log("Connected to server")})
    socket.on('disconnect', function() {console.log("Disconnect from server")})
    socket.on('message', function(messageString) {
      message = JSON.parse(messageString)
      console.log("Message from server: " + message.message)
      var handlers = {
        init : function(initMessage) {
          Template.renderElements($('#teams'), "team-name", initMessage.contenders, function(teamName, element) {
            element.text(teamName)
          })
          Template.renderElements($('#results'), "challenge-results", initMessage.challenges, function(challenge, challengeRow) {
            $('.challenge-name', challengeRow).text(challenge.name)
            Template.renderElements(challengeRow, "team-result", initMessage.contenders, function(teamName, contenderResultElement) {

            })
          })
        }
      }
      var handler = handlers[message.message];
      if (handler) handler(message);
    })
    socket.connect();
  </script>
</head>
<body>
<h1>Hello Nasty</h1>
<table>
   <thead>
    <tr id="teams">
      <th id="corner"></th>
      <th class="team-name template"></th>
    </tr>
   </thead>
   <tbody id="results">
     <tr class="challenge-results template">
       <td class="challenge-name"></td>
       <td class="team-result template"></td>
     </tr>
   </tbody>
</table>
</body>
</html>